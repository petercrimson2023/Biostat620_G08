---
title: "Plotting"
author: "Bulun Te"
date: "2024-02-16"
output:
  pdf_document: 
    latex_engine: xelatex
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r,message=FALSE, warning=FALSE}

# Load the library  
# Load data

library(tidyverse)
library(lubridate)
library(circular)
library(reshape2)
library(patchwork)
library(GGally)

# Set working directory to the project root
if (!requireNamespace("here", quietly = TRUE)) {
  install.packages("here")
}
library(here)
setwd(here())

source("EDA_func.R")

# set default language and time zone
Sys.setenv(LANGUAGE = "en")
Sys.setlocale("LC_TIME", "en_US.UTF-8")

load("GroupData.RData")

```


```{r}

plot(diff(data_xin$Total.ST.min), type = "l", col = "blue", xlab = "Time", ylab = "Total Screen Time (min)", main = "Total Screen Time for Xinwei Wang")
plot(diff(data_bulun$Total.ST.min), type = "l", col = "blue", xlab = "Time", ylab = "Total Screen Time (min)", main = "Total Screen Time for Bulun Te")
plot(diff(data_zhang$Total.ST.min), type = "l", col = "blue", xlab = "Time", ylab = "Total Screen Time (min)", main = "Total Screen Time for Xinyu Zhang")

```


```{r}

acf(data_xin$Total.ST.min, lag.max = 100, main = "ACF for Total Screen Time for Xinwei Wang")
acf(data_bulun$Total.ST.min, lag.max = 100, main = "ACF for Total Screen Time for Bulun Te")
acf(data_zhang$Total.ST.min, lag.max = 100, main = "ACF for Total Screen Time for Xinyu Zhang")

```




## Circular plot for Pickup.1st

```{r,fig.width=20, fig.height=20}

png("circular_plot.png", width=20, height=20, units="in", res=500)

par(mar=c(0.1,0.1,1,15),
        mfrow=c(3,2),
    cex=1.1)

circular_plot(data_bulun,"Bulun Te")
circular_plot(data_xin,"Xinwei Wang")
circular_plot(data_zhang,"Xinyu Zhang")
dev.off()

```


## Violin plot for Social Screen Time grouped by stayup

```{r,fig.width=15, fig.height=14}

violin_bulun = violin_plot(data_bulun,"Bulun Te",trim = TRUE)

violin_xin = violin_plot(data_xin,"Xinwei Wang")

violin_zhang = violin_plot(data_zhang,"Xinyu Zhang")


occu_bulun = plot_occupation_time_curve(data_bulun, "Social.ST.min", "Semester", c(1, 0), c("blue", "red"),"Bulun Te")
occu_xin = plot_occupation_time_curve(data_xin, "Social.ST.min", "Semester", c(1, 0), c("blue", "red"),"Xinwei Wang")
occu_zhang = plot_occupation_time_curve(data_zhang, "Social.ST.min", "Semester", c(1, 0), c("blue", "red"),"Xinyu Zhang")

violin_bulun+violin_xin+violin_zhang+occu_bulun+occu_xin+occu_zhang+plot_layout(ncol = 3)



```


```{r,fig.width=10, fig.height=9}

g_xin = plot_heatmap(data_xin, "Xinwei Wang")
g_bulun = plot_heatmap(data_bulun, "Bulun Te")
g_zhang = plot_heatmap(data_zhang, "Xinyu Zhang")

g_xin+g_bulun+g_zhang+plot_layout(ncol = 2)

```


```{r,fig.width=8, fig.height=7}

plot_pairwise(data_xin, "Xinwei Wang")
plot_pairwise(data_bulun, "Bulun Te")
plot_pairwise(data_zhang, "Xinyu Zhang")


```


## Weather grouped by stay up

```{r,fig.width=15, fig.height=6}

g_xin = plot_occupation_time_curve(data_xin, "Temperature_F", "Stay.late", c(1, 0), c("blue", "red"),"Xinwei Wang")
g_bulun = plot_occupation_time_curve(data_bulun, "Temperature_F", "Stay.late", c(1, 0), c("blue", "red"),"Bulun Te")
g_zhang = plot_occupation_time_curve(data_zhang, "Temperature_F", "Stay.late", c(1, 0), c("blue", "red"),"Xinyu Zhang")

g_xin+g_bulun+g_zhang+plot_layout(ncol = 3)

```

```{r,fig.width=15, fig.height=6}

g_xin = plot_occupation_time_curve(data_xin, "Steps", "Stay.late", c(1, 0), c("blue", "red"),"Xinwei Wang")
g_bulun = plot_occupation_time_curve(data_bulun, "Steps", "Stay.late", c(1, 0), c("blue", "red"),"Bulun Te")
g_zhang = plot_occupation_time_curve(data_zhang, "Steps", "Stay.late", c(1, 0), c("blue", "red"),"Xinyu Zhang")

g_xin+g_bulun+g_zhang+plot_layout(ncol = 3)

```






